<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>选择商品</title>
    <link href="__PUBLIC__/static/css/base.css" rel="stylesheet" type="text/css">
    <link href="__PUBLIC__/static/css/seller_center.css" rel="stylesheet" type="text/css">
    <link href="__PUBLIC__/static/font/css/font-awesome.min.css" rel="stylesheet" />
    <!--[if IE 7]>
    <link rel="stylesheet" href="__PUBLIC__/static/font/css/font-awesome-ie7.min.css">
    <![endif]-->
    <script type="text/javascript" src="__PUBLIC__/static/js/jquery.js"></script>
    <script type="text/javascript" src="__PUBLIC__/static/js/waypoints.js"></script>
    <script type="text/javascript" src="__PUBLIC__/static/js/jquery-ui/jquery-ui.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/static/js/jquery.validation.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/static/js/common.js"></script>
    <script type="text/javascript" src="__PUBLIC__/static/js/layer/layer.js"></script>
    <script type="text/javascript" src="__PUBLIC__/js/global.js"></script>
    <script type="text/javascript" src="__PUBLIC__/js/myFormValidate.js"></script>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="__PUBLIC__/static/js/html5shiv.js"></script>
    <script src="__PUBLIC__/static/js/respond.min.js"></script>
    <![endif]-->
    <style>
        .search-form {
            border-top: solid 1px #E6E6E6;
            border-bottom-width: 1px;
            border-bottom-style: solid;
            border-bottom-color: rgb(230, 230, 230);
        }
    </style>
</head>
<body style="min-width:0px;">
<div class="ncsc-layout wrapper" style="width: 1000px;margin: 0px;">
    <div id="layoutRight" class="ncsc-layout-right">
        <div class="main-content" id="mainContent">
            <form id="search-form2" method="get" action="{:U('Promotion/search_goods',array('tpl'=>'select_goods'))}">
                <table class="search-form">
                    <tr>
                        <td><a onclick="select_goods();"title="确定发送优惠券" class="ncbtn ncbtn-aqua">确定添加商品</a></td>
                        <td></td>
                        <th class="w50">商品分类</th>
                        <td class="w100">
                            <select name="cat_id" id="cat_id" class="select">
                                <option value="">所有分类</option>
                                <foreach name="categoryList" item="v" key="k" >
                                    <if condition="in_array($v[id],$bind_class_id)">
                                        <option value="{$v['id']}" <if condition="$v[id] eq $cat_id">selected</if>>{$v['name']}</option>
                                    </if>
                                </foreach>
                            </select>
                        </td>
                        <th class="w30">品牌</th>
                        <td class="w100">
                            <select name="brand_id" id="brand_id" class="select">
                                <option value="">所有品牌</option>
                                <foreach name="brandList" item="v" key="k" >
                                    <option value="{$v['id']}" <if condition="$v[id] eq $brand_id">selected</if>>{$v['name']}</option>
                                </foreach>
                            </select>
                        </td>
                        <th class="w70">新品/推荐</th>
                        <td class="w50">
                            <select name="intro" class="select">
                                <option value="0">全部</option>
                                <option value="is_new">新品</option>
                                <option value="is_recommend">推荐</option>
                            </select>
                        </td>
                        <th class="w40">关键词</th>
                        <td class="w100"><input style="width: 90px;" class="text" type="text" name="keywords" value="{$keywords}" placeholder="搜索词"/></td>
                        <td class="w70 tc"><label class="submit-border"><input type="submit" class="submit" value="搜索" /></label></td>
                    </tr>
                </table>
            </form>
            <table class="ncsc-default-table">
                <thead>
                <tr>
                    <th class="w20"></th>
                    <th class="w50">选择</th>
                    <th class="w200 tl">商品名称</th>
                    <th class="w100">价格</th>
                    <th class="w100">库存</th>
                    <th class="w100">操作</th>
                </tr>
                </thead>
                <tbody>
                <volist name="goodsList" id="list">
                    <tr class="bd-line">
                        <td></td>
                        <td>
                            <input type="radio" name="goods_id" data-img="{$list.goods_id|goods_thum_images=160,160}" data-id="{$list.goods_id}" data-name="{$list.goods_name}" data-count="{$list.store_count}" data-price="{$list.shop_price}" onclick="changeGoods(this)"/>
                        </td>
                        <td class="tl">{$list.goods_name}</td>
                        <td>{$list.shop_price}</td>
                        <td>{$list.store_count}</td>
                        <td class="nscs-table-handle">
                            <span><a onclick="$(this).parent().parent().parent().remove();" class="btn-grapefruit"><i class="icon-trash"></i><p>删除</p></a></span>
                        </td>
                    </tr>
                </volist>
                </tbody>
                <tfoot>
                <tr>
                    <td colspan="20">
                        {$page}
                    </td>
                </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>
<script>
    var goods_id = 0 , goods_name = '' , store_count = '' , goods_price = '',goods_image = '';
    function changeGoods(obj){
        goods_id = $(obj).attr('data-id');
        goods_name = $(obj).attr('data-name');
        store_count = $(obj).attr('data-count');
        goods_price = $(obj).attr('data-price');
        goods_image = $(obj).attr('data-img');
    }

    function select_goods()
    {
        if($("input[type='radio']:checked").length == 0)
        {
            layer.alert('请选择商品', {icon: 2}); //alert('请选择商品');
            return false;
        }
        window.parent.call_back(goods_id,goods_name,goods_price,store_count,goods_image);
    }
</script>
</body>
</html>
